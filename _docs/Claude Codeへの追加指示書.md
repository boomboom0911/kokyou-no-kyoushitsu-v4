
重要なポイント：
1. シンプルに保つ
2. Supabase無料プランでの運用
3. Chromebook環境（モバイル対応は後回し）
4. 教室での口頭コントロール前提
5. 過度な機能は不要

Claude Codeに伝えるべき具体的な指示をまとめよう。
:::
## 📝 Claude Codeへの追加指示書

最初の仕様書（V4_DESIGN_DOCUMENT.md）に加えて、以下の点を考慮して開発してください。

### 🎯 開発の基本方針

```markdown
# 重要な前提条件
1. **シンプル最優先** - 複雑な機能は実装しない
2. **Supabase無料プラン** - 制限内で動作すること
3. **Chromebook環境** - デスクトップ表示のみ対応（モバイル対応は不要）
4. **教室での利用** - 口頭指示との併用が前提
```

### ⚡ パフォーマンス最適化

```typescript
// Supabase無料プラン制限への対応
const SUPABASE_LIMITS = {
  maxRows: 10000,           // 年度末リセット前提
  realtimeConnections: 20,  // 同時接続数を制限
  apiRequests: 150000/月,   // リクエスト数に注意
}

// リアルタイム接続は最小限に
// - topic_posts のINSERTのみ購読
// - reactions等は手動更新またはポーリング（30秒）
```

### 🚫 実装不要な機能

```markdown
## 実装しないもの
- 授業状態の細かな管理機能
- 教師用クイックアクション（ハイライト、ピン留め等）
- 高度な分析・可視化機能
- AI関連機能
- PWA/モバイル対応
- 座席レイアウトのカスタマイズ
- 複雑な認証（Google OAuth等）
```

### ✅ 必須実装事項

```markdown
## Phase 1で必ず実装
1. セッションコード + メールアドレスでの簡易認証
2. 42席固定の座席選択
3. トピック投稿（1人1回）
4. 投稿のリアルタイム表示

## Phase 2で実装
1. 漢字リアクション（驚・納・疑）
2. 簡易学習メモ
3. 生徒個人のポートフォリオ画面（自分の記録のみ）
```

### 💾 データ管理

```sql
-- 90日以上前のデータは自動アーカイブを検討
-- ただし初期実装では不要（年度末に手動対応）

-- ビューやマテリアライズドビューは使わない
-- 単純なテーブル構造のみで実装
```

### 🖥️ UI設計指針

```css
/* Chromebook (1366x768) に最適化 */
.classroom-container {
  max-width: 1200px;
  height: calc(100vh - 60px);
  /* スクロール不要な設計 */
}

/* 座席は6×7グリッド固定 */
.seat-grid {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  grid-template-rows: repeat(7, 1fr);
  gap: 8px;
  aspect-ratio: 6/7;
}
```

### 🔒 セキュリティ

```typescript
// 学校ドメインのメールのみ許可
const isValidSchoolEmail = (email: string) => {
  return email.endsWith('@nansho.ed.jp') // 実際のドメインに変更
}

// RLSは最小限でOK（複雑なポリシーは不要）
```

### 📊 想定データ規模

```typescript
// 年間想定
const YEARLY_SCALE = {
  sessions: 350,        // 5クラス × 70回
  students: 200,        // 5クラス × 40人
  posts: 12000,         // 350回 × 35人平均
  reactions: 36000,     // posts × 3
  
  // この規模ならSupabase無料プランで問題なし
}
```

### 🚀 開発優先順位

```markdown
1. **まず動くものを作る**
   - エラーハンドリングは基本的なもののみ
   - 完璧を求めない

2. **実際の授業で試す**
   - 1クラスでテスト運用
   - フィードバックを収集

3. **必要な改善のみ行う**
   - 実際に問題になったことだけ修正
   - 「あったらいいな」は実装しない
```

### ⚠️ 注意事項

```markdown
- LocalStorageの多用は避ける（Chromebookのストレージは小さい）
- 音や通知は控えめに（教室での利用を考慮）
- CSV出力は基本的なもののみ（高度な集計は不要）
- 年度末にデータリセットする運用を前提とする
```

### 💬 最重要

**「教室で実際に使える最小限の機能」を確実に動かすことが最優先です。**

追加機能は実際の利用を通じて本当に必要だと判明したもののみ実装してください。

---

これらの指示を仕様書と合わせて参照し、**シンプルで確実に動くアプリ**を作ってください。